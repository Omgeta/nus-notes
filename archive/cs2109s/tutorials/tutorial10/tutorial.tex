\documentclass[12pt, a4paper]{article}

\usepackage[a4paper, margin=1in]{geometry}

\input{preamble}
\input{letterfonts}

\newcommand{\mytitle}{CS2109S Tutorial 10}
\newcommand{\myauthor}{github/omgeta}
\newcommand{\mydate}{AY 25/26 Sem 1}

\begin{document}
\raggedright
\footnotesize
\begin{center}
{\normalsize{\textbf{\mytitle}}} \\
{\footnotesize{\mydate\hspace{2pt}\textemdash\hspace{2pt}\myauthor}}
\end{center}
\setlist{topsep=-1em, itemsep=-1em, parsep=2em}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                      Begin                         %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{enumerate}[\Alph*.]
  \item 
    \begin{enumerate}[\arabic*.]
      \item $w^\top x = -0.1 < 0$ so SVM classifies $x$ as Not-VIP

      \item We need $17$ support vectors, each of $30$ attributes, and $17$ $\alpha$ coefficients, giving total cost of $17\times 30 + 17 = 527$
    \end{enumerate}

  \item 
    \begin{enumerate}[\arabic*.]
      \item Total variance = $\frac{6^2 + 4.5^2 + 2^2 + 1^2 + 0.5^2}{n-1} = \frac{61.5}{n-1}$\\
        Keeping $6, 4$ gives variance $\frac{6^2 + 4^2}{61.5} = 0.915 > 0.9$ so suffice to keep just them.

      \item For compressing $64 \times 64 = 4096$ mean-centered features to $50$ features, we need compression matrix $\tilde{U} \in \RR^{4096 \times 50}$, the $4096$ feature means for normalisation and denormalisation. For decompression of the original image, we already have $\tilde{U}$, so we only need the additional compressed images of $50 \times 500 = 25000$ values. So in total we have $(4096 \times 50) + 25000 + 4096 = 233896$.
    \end{enumerate}
 
  \item 
    \begin{enumerate}[\arabic*.]
      \item $\hat{y} = \operatorname{ReLU}(W^{[2]\top}(W^{[1]\top} \begin{bmatrix}1\\1\end{bmatrix})) = \operatorname{ReLU}(W^{[2]\top}\begin{bmatrix}3\\2\end{bmatrix}) = \operatorname{ReLU}(8) = 8$

      \item Note $J(W) = L_1 + L_2 = \frac{1}{2\times 2}((\hat{y}^{(1)} - y^{(1)})^2 + (\hat{y}^{(2)} - y^{(2)})^2)$ so:
        \begin{align*}
          \frac{\partial J(W)}{\partial W^{[1]}_{11}} = \frac{\partial L_1}{\partial W_{11}^{[1]}} + \frac{\partial L_2}{\partial W_{11}^{[1]}}
        \end{align*}
        Note also for any sample $i$, $\hat{y}^{(i)}$ predicted as:
        \begin{align*}
          L_i = \frac{1}{4}(\hat{y}^{(i)} - y^{(i)})^2 &\implies \frac{\partial L_i}{\partial \hat{y}^{(i)}} = \frac{1}{2}(\hat{y}^{(i)} - y^{(i)})\\
          \hat{y}^{(i)} = \operatorname{ReLU}(f^{(i)}) &\implies \frac{\partial y^{(i)}}{\partial f^{(i)}} = 1_{f^{i)} > 0}\\
          f^{(i)} = W_{11}^{[2]}a_1^{(i)} + W_{21}^{a_2^{(i)}} &\implies \frac{\partial f^{(i)}}{\partial a_1^{(i)}} = W_{11}^{[2]}\\
          a_1^{(i)} = W_{11}^{[1]}x_1^{(i)} + W_{21}^{[1]}x_2 &\implies \frac{\partial a_1^{(i)}}{\partial W_{11}^{[1]}} = x_1^{(i)}
        \end{align*}
        Then by chain rule, $\frac{\partial L_i}{\partial W_{11}^{[1]}} = \frac{1}{2}(\hat{y}^{(i)} - y^{(i)})1_{f^{i)} > 0}W_{11}^{[2]} x_1^{(i)}$ so $\frac{\partial J(W)}{\partial W_{11}^{[1]}} = 4 + 0 = 4$
    \end{enumerate}

  \item 
    \begin{enumerate}[\arabic*.]
      \item Kernel size = $2 \times 2 \times 3$ ($H \times W \times C$), with 5 kernels to produce 5-channel output.\\Therefore, total parameters = $2 \times 2 \times 3 \times 5 = 60$

      \item Kernel size = $1 \times 1 \times 3$ with all 3 weights as $\frac{1}{3}$, stride = $1$, padding = $0$ 
    \end{enumerate}
\end{enumerate}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                       End                          %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\end{document}
